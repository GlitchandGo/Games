<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Rarity Clicker</title>
    <style type="text/css">
      body {
        background-color: white;
        font-family: Arial, sans-serif;
        color: black;
        margin: 20px;
        padding: 0;
      }
      /* Shopping cart at top right */
      #cart {
        position: absolute;
        top: 10px;
        right: 10px;
      }
      a.cart-link {
        text-decoration: none;
        font-weight: bold;
        color: blue;
        font-size: 12px;
      }
      button {
        font-size: 16px;
        padding: 8px 16px;
      }
      #score {
        font-weight: bold;
        margin-top: 10px;
      }
      #log {
        border: 1px solid #000;
        padding: 4px;
        margin-top: 10px;
        height: 150px;
        overflow: auto;
      }
    </style>
    <script type="text/javascript">
      // Check for a background color parameter in the URL (e.g., index.html?bg=%23FFCCCC)
      function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
          var pair = vars[i].split("=");
          if (pair[0] == variable) { return pair[1]; }
        }
        return null;
      }
      var chosenBg = getQueryVariable("bg");
      if (chosenBg != null && chosenBg != "") {
        // Use document.write early to inject a style block that overrides the background color.
        document.write('<style type="text/css">body { background-color: ' + chosenBg + '; }</style>');
      }

      // Global score and log variables.
      var score = 0;
      var logStr = "";

      // The main function: run when you click the button.
      function getRarity() {
        var r = Math.random() * 100; // r will be in the range [0, 100)
        var outcome = "";
        var points = 0;
        // Using your specified intervals:
        if (r < 50) {
          outcome = "Common";
          points = 0;
        } else if (r < 76) {  // 50 <= r < 76 --> Uncommon
          outcome = "Uncommon";
          points = 1;
        } else if (r < 89) {  // 76 <= r < 89 --> Rare
          outcome = "Rare";
          points = 2;
        } else if (r < 95) {  // 89 <= r < 95 --> Epic
          outcome = "Epic";
          points = 4;
        } else if (r < 98) {  // 95 <= r < 98 --> Legendary
          outcome = "Legendary";
          points = 8;
        } else if (r >= 98.1 && r < 99) {  // 98.1 <= r < 99 --> Mythic
          outcome = "Mythic";
          points = 20;
        } else if (r >= 99.1 && r < 99.5) {  // 99.1 <= r < 99.5 --> Chroma
          outcome = "Chroma";
          points = 50;
        } else if (r >= 99.6 && r < 99.8) {  // 99.6 <= r < 99.8 --> Impossible
          outcome = "Impossible";
          points = 80;
        } else if (r >= 99.8 && r < 99.95) {  // 99.8 <= r < 99.95 --> Ethereal
          outcome = "Ethereal";
          points = 150;
        } else if (r >= 99.95 && r < 100) {  // 99.95 <= r < 100 --> Secret
          outcome = "Secret";
          points = 300;
        } else {
          // If r falls into one of the tiny gaps, default to Legendary.
          outcome = "Legendary";
          points = 8;
        }
        score += points;
        document.getElementById("score").innerHTML = "Score: " + score;
        logStr += outcome + " (" + points + " points)<br>";
        document.getElementById("log").innerHTML = logStr;
        document.getElementById("result").innerHTML = "You got: " + outcome + " (" + points + " points)";
      }
    </script>
  </head>
  <body>
    <!-- Shopping cart link -->
    <div id="cart">
      <a class="cart-link" href="shop.html">[Shopping Cart]</a>
    </div>
    <h1>Rarity Clicker</h1>
    <button onclick="getRarity()">Click me!</button>
    <p id="result">&nbsp;</p>
    <p id="score">Score: 0</p>
    <div id="log">
      <!-- The log of finds will appear here -->
    </div>
  </body>
</html>
